!function(c){const n={init(){c("body").on("click",".md-content-generator-btn",function(t){t.preventDefault(),n.generateAiContent(t)}),c("body").on("keyup",".md-ai-prompt-box",function(t){t.preventDefault(),""===c(this).val()?c(".md-content-generator-btn").attr("aria-disabled","true"):c(".md-content-generator-btn").attr("aria-disabled","false")}),c("body").on("click",".md-ai-popup-modal-dismiss",function(t){t.preventDefault(),c(".md-ai-content-writer-popup-block").removeClass("md-ai-content-writer-popup-block-open")}),c("body").on("click","#md-content-writer-btn",function(t){t.preventDefault(),c(".md-ai-api-error").html(""),c(".md-ai-prompt-box").html(""),c(".md-ai-content-writer-popup-block").addClass("md-ai-content-writer-popup-block-open")})},showGeneralError:()=>{c("#md-ai-content-writer-locations-render-search-result").html(md_ai_content_writer_admin_ajax_object.general_error),n.afterAjaxAction(),setTimeout(function(){c(".winemaker_render_loading_spinner").html("")},500)},beforeAjaxAction:()=>{c("body").css("cursor","progress"),c(".md-content-generator-btn").addClass("is-busy"),c(".md-ai-api-error").html(""),setTimeout(function(){var e,n,t,r,o,a,i;""==c(".md-ai-api-error").html()&&(t=c(".md-ai-api-generating-content"),e=t,n=md_ai_content_writer_admin_ajax_object.generating_content,t=50,r="",o=n.length,a=0,e.text(""),i=setInterval(function(){var t=r+n.charAt(a);e.text(t),r=t,a===o-1&&clearInterval(i),a+=1},t))},5e3)},afterAjaxAction:()=>{c("body").css("cursor",""),c(".md-content-generator-btn").removeClass("is-busy"),c(".md-ai-content-writer-popup-block").removeClass("md-ai-content-writer-popup-block-open"),c(".md-ai-api-error").html(""),c(".md-ai-api-generating-content").html("")},errorAfterAjaxAction:()=>{c("body").css("cursor",""),c(".md-content-generator-btn").removeClass("is-busy")},generateAiContent:()=>{var t=wp.data.select("core/editor").getCurrentPostId();c.ajax({type:"post",dataType:"json",url:md_ai_content_writer_admin_ajax_object.ajax_url,data:{action:"md_ai_content_writer_for_builder",_nonce:md_ai_content_writer_admin_ajax_object.ajax_nonce,prompt:c(".md-ai-prompt-box").val(),skip_content:c(".md-ai-skip-content-generate").is(":checked"),image:c(".md-ai-generate-image").is(":checked"),conclusion:c(".md-ai-add-conclusion").is(":checked"),excerpt:c(".md-ai-add-excerpt").is(":checked"),post_id:t},beforeSend:()=>{n.beforeAjaxAction()},success(t){if(0==t.success)c(".md-ai-api-generating-content").html(""),c(".md-ai-api-error").html(t.content),n.errorAfterAjaxAction();else{if(tinymce.activeEditor)c("#title").siblings("label").addClass("screen-reader-text"),c("#title").val(t.title),setTimeout(function(){tinymce.activeEditor.execCommand("mceInsertContent",!1,t.content)},1e3),c(".excerpt").length&&c("#excerpt").length&&c("#excerpt").text(c(".excerpt p").text());else{if(null==wp.data.dispatch("core/block-editor"))return;t.title&&wp.data.dispatch("core/editor").editPost({title:t.title});var e=wp.blocks.createBlock("core/paragraph",{content:t.content});wp.data.dispatch("core/block-editor").insertBlocks(e),""!==t.conc_title&&(e=wp.blocks.createBlock("core/heading",{content:t.conc_title}),wp.data.dispatch("core/block-editor").insertBlocks(e),""!==t.conc_content&&(e=wp.blocks.createBlock("core/paragraph",{content:t.conc_content}),wp.data.dispatch("core/block-editor").insertBlocks(e))),""!==t.excerpt_data&&c("textarea#inspector-textarea-control-0").val(t.excerpt_data)}setTimeout(function(){c(".editor-post-publish-button").trigger("click")},200),n.afterAjaxAction()}},error(){n.showGeneralError()}})}};c(function(){n.init()})}(jQuery),function(t){var e=document.getElementById("editor");e&&t.data.subscribe(function(){setTimeout(function(){var t;null==document.getElementsByClassName("md-content-writer-toolbar-btn")[0]&&(t=e.querySelector(".edit-post-header-toolbar"))instanceof HTMLElement&&t.insertAdjacentHTML("beforeend",'<a id="md-content-writer-btn" class="md-content-writer-toolbar-btn md-content-writer-loading" href="#" >AI Content Writer <span class="md-content-writer-aiwa-spinner md-content-writer-hide-spin"></span></a>')},1)})}((window,wp));